import { useEffect, useRef } from "react";

// emoji z firmware
const emojiBitmaps: number[][] = [
  [0x38, 0x44, 0x94, 0x44, 0x46, 0x95, 0x44, 0x38], // 0: ğŸ®
  [0x7c, 0x46, 0x4a, 0x5a, 0x5a, 0x4a, 0x46, 0x7c], // 1: ğŸ’¼
  [0x10, 0xf8, 0x8c, 0xe6, 0x86, 0x8c, 0xf8, 0x10], // 2: ğŸ 
  [0x00, 0x00, 0xc7, 0x7c, 0x7c, 0xc7, 0x00, 0x00], // 3: ğŸ”§
  [0x00, 0x80, 0xc8, 0x6c, 0x3e, 0x1b, 0x09, 0x00], // 4: âš¡
  [0x00, 0x3e, 0x41, 0x5d, 0x51, 0x4e, 0x20, 0x00], // 5: ğŸ“§
  [0x3e, 0x22, 0xa2, 0xe2, 0xe2, 0xa2, 0x22, 0x3e], // 6: ğŸ’»
  [0xc0, 0xfe, 0xc2, 0x02, 0x62, 0x7e, 0x60, 0x00], // 7: ğŸµ
  [0xc0, 0xa0, 0x50, 0x28, 0x1c, 0x0a, 0x07, 0x03], // 8: ğŸ“
  [0x7e, 0xc2, 0xc2, 0xc2, 0xc2, 0xfe, 0x64, 0x3c], // 9: â˜•
  [0xd8, 0xf0, 0x78, 0x7c, 0x5e, 0x0f, 0x07, 0x03], // 10: ğŸ—¡ï¸
  [0x00, 0x0c, 0x12, 0x22, 0x44, 0x22, 0x12, 0x0c], // 11: â¤ï¸
  [0x40, 0x7c, 0xc6, 0xc6, 0x7c, 0x40, 0x00, 0x00], // 12: ğŸ””
  [0x40, 0xa0, 0x91, 0x8f, 0x8f, 0x91, 0xa0, 0x40], // 13: ğŸ§ª
  [0x78, 0xfe, 0xf9, 0xc9, 0xf9, 0xfe, 0x78, 0x00], // 14: ğŸ”’
  [0x0c, 0x0e, 0x4f, 0x8f, 0x7f, 0x0f, 0x0e, 0x0c], // 15: â˜‚ï¸
  [0x06, 0x15, 0xff, 0x7d, 0xff, 0x40, 0x30, 0x00], // 16: ğŸ¦•
  [0x3e, 0x45, 0x47, 0xf5, 0xcf, 0x83, 0x82, 0x84], // 17: ğŸ‘»
  [0x07, 0x06, 0x06, 0x0e, 0x16, 0x96, 0xfe, 0x7c], // 18: ğŸ”«
  [0x82, 0xee, 0x92, 0x92, 0x92, 0xee, 0x82, 0x00], // 19: â³
  [0x20, 0x4f, 0x9e, 0xff, 0x9e, 0x4f, 0x20, 0x00], // 20: ğŸŒ·
];

export const EmojiCanvas: React.FC<{ emojiIndex: number; color: string, size?: number }> = ({ emojiIndex, color, size = 16 }) => {
  const canvasRef = useRef<HTMLCanvasElement>(null);

  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    const bitmap = emojiBitmaps[emojiIndex] || emojiBitmaps[0];
    const scale = size / 8;

    ctx.clearRect(0, 0, size, size);
    for (let x = 0; x < 8; x++) {
      for (let y = 0; y < 8; y++) {
        if (bitmap[x] & (1 << y)) {
          ctx.fillStyle = color;
          ctx.fillRect(x * scale, y * scale, scale, scale);
        }
      }
    }

    ctx.imageSmoothingEnabled = false;
  }, [emojiIndex, size]);

  return <canvas ref={canvasRef} width={size} height={size} className="inline-block" />;
};
